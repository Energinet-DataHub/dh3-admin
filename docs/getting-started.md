# Prerequisites

- [We recommend using VOLTA to manage your JavaScript command-line tools](volta.sh)
- Node.jsÂ® version 14.18.1
- Yarn - Please use Yarn v1 instead of npm to install dependencies  
`npm install --global yarn@1.22.17`

## Visual Studio Code - recommended extensions

- Angular Language Service
- Prettier - Code formatter
- Nx Console
- EditorConfig for VS Code
- markdownlint
- ESLint

## DataHub Application (app-dh)

Deployed version of the application can be found [here.](https://cdn-dh-endpoint-dh-u-001.azureedge.net/)  
Currently the application is only deployed to a single environment.

### Running the application

To run the application locally you need to serve the frontend application and corrosponding BFF (Backend for frontend).

#### Frontend application

`yarn nx serve app-dh`  

#### BFF (backend for frontend)

`yarn nx serve api-dh`

### Testing

Currently the test suites are integrating with the BFF (backend for frontend), so to run the tests succesfully make sure you're already serving the backend locally.

`yarn test`

While developing you can run the tests in watch mode:

`yarn test --watch`

### Generating new components

New components can be generated by the command-line or through the Nx Console extension from Visual Studio Code.

`yarn nx generate @schematics/angular:component --name=<my-new-awesome-component> --project=<library-name> --prefix=dh --skipImport`

### Generating new libraries

New libraries can be generated by the command-line or through the Nx Console extension from Visual Studio Code.

`nx generate @nrwl/angular:library --name=<libary type>-my-awesome-library --directory=dh/<domain> --importPath=@energinet-datahub/dh/metering-point/my-awesome-lib --prefix=dh --skipPackageJson --standaloneConfig --tags=product:dh,domain:<domain>,type:<library type>`

## Design System

The design system is deployed through chromatic, and can be found here:  
[Latest version (main)](https://main--61765fc47451ff003afe62ff.chromatic.com/)

You can also find a deployed version of your specific branch here (direct link, can also be found under checks in a pull-request):  
`https://<branch>--61765fc47451ff003afe62ff.chromatic.com`

### Running it locally

`yarn designsystem:start`

## Architecture

The repository is a mono-repo which hosts serveral applications.  
This means that dependencies are shared by every application inside this repository.  
`Example: every application is running the same version of Angular.`

The repository is setup using [Nx from NRWL](https://nx.dev/l/a/getting-started/intro) which means that you shouldn't use the `Angular CLI` directly.

### Dependency graph / Project Graph

You can generate a dependency graph by running following command, to get an overview of the applications in the mono-repo:

`yarn dep-graph`
