<ng-container *transloco="let transloco; read: 'wholesale'">
  <ng-container *rxLet="batch$; let batch">
  <watt-top-bar>
    <div class="header">
      <watt-breadcrumbs>
        <watt-breadcrumb (click)="navigateToSearchBatch()">{{
          transloco("searchBatch.topBarTitle")
        }}</watt-breadcrumb>
        <watt-breadcrumb (click)="navigateToSearchBatch(batch)">{{
          transloco("batchDetails.headline", { batchNumber: batch?.batchNumber })
        }}</watt-breadcrumb>
        <watt-breadcrumb>{{
          transloco("calculationSteps.breadcrumb", {
            gridAreaCode: gridAreaCode,
            gridAreaName: transloco('calculationSteps.gridAreaName')
          })
        }}</watt-breadcrumb>
      </watt-breadcrumbs>

      <h2>
        {{transloco('calculationSteps.gridAreaName')}}
        <watt-badge type="info">
          {{ transloco("searchBatch." + batch?.executionState) }}
        </watt-badge>
      </h2>

      <p>
        <small>{{
          transloco("calculationSteps.subHeading", {
            gridAreaCode: gridAreaCode
          })
        }}</small>
      </p>
    </div>
  </watt-top-bar>

  <main>
    <ul class="steps">
      <li>
        <dh-wholesale-production-per-gridarea [batch]="batch" [gridAreaCode]="gridAreaCode"></dh-wholesale-production-per-gridarea>
      </li>
    </ul>

    <ng-template #loading>
      <div class="loading-container">
        <watt-spinner></watt-spinner>
      </div>
    </ng-template>

    <ng-template #error>
      <watt-empty-state
        icon="custom-power"
        [title]="transloco('calculationSteps.loadCalculationStepsFailedTitle')"
        [message]="transloco('calculationSteps.loadCalculationStepsFailedMessage')"
      >
      </watt-empty-state>
    </ng-template>

    <aside class="details">
      <watt-card>
        <watt-card-title>
          <h3>Detaljer</h3>
        </watt-card-title>

        <dl *ngIf="batch">
          <dt class="watt-label">
            {{ transloco("batchDetails.calculationPeriod") }}
          </dt>
          <dd>
            {{ batch.periodStart | dhDate }} - {{ batch.periodEnd | dhDate }}
          </dd>

          <dt class="watt-label">
            {{ transloco("batchDetails.executionTime") }}
          </dt>
          <dd>{{ batch.executionTimeStart | dhDateTime }}</dd>
        </dl>
      </watt-card>
    </aside>
  </main>
  </ng-container>
</ng-container>
